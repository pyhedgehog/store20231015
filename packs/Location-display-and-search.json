{"description":"Location-based search with map display","name":"Location display and search","pack":{"pages":[{"name":"Libraries","title":"","layout":{"above":[{"type":"blank","contents":"Public libraries in England","isFormula":{},"textStyle":"h1"},{"widths":[3,6,3],"besides":[null,{"name":"d3eb7c","type":"view","view":"LocInput","state":"shared"},null]},{"widths":[6,6],"besides":[{"above":[{"type":"line_break"},{"name":"5ecb77","type":"view","view":"LibMap","state":"shared"}]},{"name":"73ed2d","type":"view","view":"LocFeed","state":"shared"}]}]},"min_role":10,"description":"","fixed_states":{},"root_page_for_roles":["admin","staff","user","public"]}],"views":[{"name":"LibraryPeek","table":"EnglandLibraries","min_role":10,"on_root_page":false,"viewtemplate":"Show","configuration":{"layout":{"above":[{"type":"field","fieldview":"as_text","textStyle":"h3","field_name":"library_name"},{"type":"line_break"},{"type":"field","fieldview":"as_text","field_name":"address"},{"type":"line_break"},{"type":"field","fieldview":"as_text","field_name":"postcode"},{"type":"line_break"},{"type":"view_link","view":"Own:LibraryShow","minRole":10,"view_label":"See more..."}]},"columns":[{"type":"Field","fieldview":"as_text","field_name":"library_name"},{"type":"Field","fieldview":"as_text","field_name":"address"},{"type":"Field","fieldview":"as_text","field_name":"postcode"},{"type":"ViewLink","view":"Own:LibraryShow","minRole":10}],"viewname":"LibraryPeek"}},{"name":"LocInput","table":"EnglandLibraries","min_role":10,"on_root_page":false,"viewtemplate":"Geosearch input","configuration":{"viewname":"LocInput","mylocation":true,"latitude_field":"lat","longtitude_field":"long"}},{"name":"Liblist","table":"EnglandLibraries","min_role":10,"on_root_page":false,"viewtemplate":"List","configuration":{"layout":{"above":[null,{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Library service","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"library_service"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Library name","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"library_name"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Address","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"address"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Postcode","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"postcode"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Type","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"type"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Closed date","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"closed_date"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Notes","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"notes"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Hours open per week","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"hours_openperweek"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Staffed hours per week","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"staffed_hoursperweek"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Contact email","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"contact_email"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"URL","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"as_text","textStyle":"","field_name":"url"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Lat","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"show","textStyle":"","field_name":"lat"}]}]},{"type":"line_break"},{"widths":[2,10],"besides":[{"above":[null,{"type":"blank","block":false,"contents":"Long","textStyle":""}]},{"above":[null,{"type":"field","block":false,"fieldview":"show","textStyle":"","field_name":"long"}]}]},{"type":"line_break"}]},"columns":[{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"library_service","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"library_name","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"address","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"postcode","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"type","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"closed_date","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"notes","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"hours_openperweek","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"staffed_hoursperweek","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"contact_email","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"as_text","link_text":"","field_name":"url","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"show","link_text":"","field_name":"lat","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""},{"stat":"Count","type":"Field","view":"Own:LibraryPeek","link_url":"","fieldview":"show","link_text":"","field_name":"long","join_field":"","view_label":"","action_name":"Delete","state_field":"on","action_label":"","agg_relation":"","header_label":""}],"viewname":"Liblist","default_state":{"lat":null,"url":"","long":null,"type":"","notes":"","address":"","postcode":"","closed_date":"","library_name":"","contact_email":"","library_service":"","_omit_state_form":false,"hours_openperweek":"","staffed_hoursperweek":""},"view_to_create":"","create_view_label":"","create_view_display":"Link"}},{"name":"LocFeed","table":"EnglandLibraries","min_role":10,"on_root_page":false,"viewtemplate":"Feed","configuration":{"cols_lg":1,"cols_md":1,"cols_sm":1,"cols_xl":1,"in_card":true,"viewname":"LocFeed","show_view":"LibraryPeek","descending":false,"order_field":"library_service","rows_per_page":20,"view_to_create":"","create_view_display":"Link"}},{"name":"LibraryShow","table":"EnglandLibraries","min_role":10,"on_root_page":false,"viewtemplate":"Show","configuration":{"layout":{"above":[{"widths":[6,6],"besides":[{"above":[{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"Library service","isFormula":{}}]},{"above":[null,{"type":"field","fieldview":"as_text","field_name":"library_service"}]}]},{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"Library name","isFormula":{}}]},{"above":[null,{"type":"field","fieldview":"as_text","field_name":"library_name"}]}]},{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"Address","isFormula":{}}]},{"above":[null,{"type":"field","fieldview":"as_text","field_name":"address"}]}]},{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"Postcode","isFormula":{}}]},{"above":[null,{"type":"field","fieldview":"as_text","field_name":"postcode"}]}]},{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"Type","isFormula":{}}]},{"above":[null,{"type":"field","fieldview":"as_text","field_name":"type"}]}]},{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"Closed date","isFormula":{}}]},{"above":[null,{"type":"field","fieldview":"as_text","field_name":"closed_date"}]}]},{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"Notes","isFormula":{}}]},{"above":[null,{"type":"field","fieldview":"as_text","field_name":"notes"}]}]},{"type":"line_break"},{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"Hours open per week","isFormula":{}}]},{"above":[null,{"type":"field","fieldview":"as_text","field_name":"hours_openperweek"}]}]},{"type":"line_break"},{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"Staffed hours per week","isFormula":{}}]},{"above":[null,{"type":"field","fieldview":"as_text","field_name":"staffed_hoursperweek"}]}]},{"type":"line_break"},{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"Contact email","isFormula":{}}]},{"above":[null,{"url":"'mailto:'+contact_email","text":"contact_email","type":"link","isFormula":{"url":true,"text":true}}]}]},{"widths":[4,8],"besides":[{"above":[null,{"type":"blank","contents":"URL","isFormula":{}}]},{"above":[null,{"url":"url","text":"url","type":"link","isFormula":{"url":true,"text":true}}]}]}]},{"name":"3f2b2","type":"view","view":"LibMap","state":"shared"}]},{"type":"line_break"}]},"columns":[{"type":"Field","fieldview":"as_text","field_name":"library_service"},{"type":"Field","fieldview":"as_text","field_name":"library_name"},{"type":"Field","fieldview":"as_text","field_name":"address"},{"type":"Field","fieldview":"as_text","field_name":"postcode"},{"type":"Field","fieldview":"as_text","field_name":"type"},{"type":"Field","fieldview":"as_text","field_name":"closed_date"},{"type":"Field","fieldview":"as_text","field_name":"notes"},{"type":"Field","fieldview":"as_text","field_name":"hours_openperweek"},{"type":"Field","fieldview":"as_text","field_name":"staffed_hoursperweek"}],"viewname":"LibraryShow"}},{"name":"LibMap","table":"EnglandLibraries","min_role":10,"on_root_page":false,"viewtemplate":"Leaflet map","configuration":{"height":600,"viewname":"LibMap","popup_view":"LibraryPeek","popup_width":300,"rows_per_page":20,"latitude_field":"lat","longtitude_field":"long"}}],"tables":[{"name":"EnglandLibraries","fields":[{"name":"library_service","type":"String","label":"Library service","stored":false,"required":true,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"library_name","type":"String","label":"Library name","stored":false,"required":true,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"address","type":"String","label":"Address","stored":false,"required":false,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"postcode","type":"String","label":"Postcode","stored":false,"required":false,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"type","type":"String","label":"Type","stored":false,"required":true,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"closed_date","type":"String","label":"Closed date","stored":false,"required":false,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"notes","type":"String","label":"Notes","stored":false,"required":false,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"hours_openperweek","type":"String","label":"Hours open per week","stored":false,"required":false,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"staffed_hoursperweek","type":"String","label":"Staffed hours per week","stored":false,"required":false,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"contact_email","type":"String","label":"Contact email","stored":false,"required":false,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"url","type":"String","label":"URL","stored":false,"required":false,"is_unique":false,"attributes":{},"calculated":false,"expression":null},{"name":"lat","type":"Float","label":"Lat","stored":true,"required":false,"is_unique":false,"attributes":{},"calculated":true,"expression":"geocode_lat({postalcode: postcode, country: 'UK' })"},{"name":"long","type":"Float","label":"Long","stored":true,"required":false,"is_unique":false,"attributes":{},"calculated":true,"expression":"geocode_long({postalcode: postcode, country: 'UK' })"}],"versioned":false,"min_role_read":1,"min_role_write":1}],"plugins":[{"name":"leaflet-map","source":"npm","location":"@saltcorn/leaflet-map"},{"name":"any-bootstrap-theme","source":"npm","location":"@saltcorn/any-bootstrap-theme"},{"name":"nominatim-geocode","source":"npm","location":"@saltcorn/nominatim-geocode"},{"name":"geosearch","source":"npm","location":"@saltcorn/geosearch"}]}}
